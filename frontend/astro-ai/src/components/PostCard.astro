---
import AIBadge from "./AIBadge.astro";

interface Props {
  title: string;
  slug: string;
  excerpt?: string;
  publishedAt?: string;
  featureImage?: string;
  tags?: { name: string; slug: string }[];
}

const {
  title,
  slug,
  excerpt,
  publishedAt,
  featureImage,
  tags = [],
} = Astro.props;

const formattedDate = publishedAt
  ? new Date(publishedAt).toLocaleDateString("zh-TW", {
      year: "numeric",
      month: "short",
      day: "numeric",
    })
  : "";
---

<article
  class="group border border-border rounded-lg overflow-hidden hover:border-accent/50 transition-colors bg-surface/30"
>
  {
    featureImage && (
      <a href={`/post/${slug}`} class="block">
        <img
          src={featureImage}
          alt={title}
          class="w-full h-48 object-cover group-hover:opacity-90 transition-opacity"
        />
      </a>
    )
  }
  <div class="p-6">
    <div class="flex items-center gap-3 text-xs text-text-muted mb-3">
      <AIBadge size="sm" />
      {formattedDate && <time datetime={publishedAt}>{formattedDate}</time>}
      {
        tags.length > 0 && (
          <div class="flex gap-1.5">
            {tags.map((tag) => (
              <span class="px-1.5 py-0.5 bg-primary rounded text-accent">
                #{tag.name}
              </span>
            ))}
          </div>
        )
      }
    </div>
    <h2 class="text-xl font-bold mb-2">
      <a
        href={`/post/${slug}`}
        class="text-text no-underline hover:text-accent transition-colors"
      >
        {title}
      </a>
    </h2>
    {
      excerpt && (
        <p class="text-text-muted text-sm leading-relaxed line-clamp-3">
          {excerpt}
        </p>
      )
    }
  </div>
</article>
